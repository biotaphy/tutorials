<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Biotaphy Tutorials &mdash; Biotaphy Tutorials 1.0a1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Biotaphy Tutorials
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/glossary.html">Biotaphy Tutorial Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Biotaphy Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Biotaphy Tutorials</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/w1_overview.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="biotaphy-tutorials">
<h1>Biotaphy Tutorials<a class="headerlink" href="#biotaphy-tutorials" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>These tutorials step through the process of running a Biotaphy tool (or command) with
example data.  There are several entry points to the tools.  These tutorials cover
running them through a command line script, which creates a Docker container, installs
the tools, executes the processes, and returns the outputs to the local machine.</p>
</section>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this heading"></a></h2>
<p>To run Biotaphy tools on any OS, locally through Docker, first download and install
<a class="reference external" href="https://docs.docker.com/get-started/">Docker</a>.</p>
</section>
<section id="host-and-container-input-output-log-directories">
<h2>Host and Container input, output, log directories<a class="headerlink" href="#host-and-container-input-output-log-directories" title="Permalink to this heading"></a></h2>
<p>A named volume <code class="docutils literal notranslate"><span class="pre">data</span></code>, is created on the host machine, and the data directory in this
repository is copied to it, then mounted at /volumes/data in the container.  This
volume is read-only, and can only be modified from the host.  If modified, the docker
<code class="docutils literal notranslate"><span class="pre">data</span></code> volume must be re-created to propogate those changes to the containers.</p>
<p>A named volume <code class="docutils literal notranslate"><span class="pre">output</span></code> is created on the host machine and mounted at /volumes/output
in the container.  Changes in this directory are saved in the volume, and copied back
to the host machine.</p>
</section>
<section id="data-preparation-tool-configuration-file">
<h2>Data preparation: Tool Configuration File<a class="headerlink" href="#data-preparation-tool-configuration-file" title="Permalink to this heading"></a></h2>
<p>All commands require a configuration file with tool-specific parameters.  The file
must be in JSON format, with parameter names enclosed in double quotes, and string
values enclosed in double quotes.  Each tutorial contains an example configuration file
in the docker/&lt;tool_name&gt; directory.  The tutorial configuration files reference example
data and parameters reasonable for that data.  All required and optional parameters
are described in individual tutorial pages.</p>
<p>Input and output files referenced in the configuration file are intended for the Docker
container, so directory paths reference volumes mounted in the container.  Output file
parameters (log files, data files) must be in the /volumes/output path, which allows
writing.</p>
</section>
<section id="run-tool-tutorials">
<h2>Run tool tutorials<a class="headerlink" href="#run-tool-tutorials" title="Permalink to this heading"></a></h2>
<p>The “run_tutorial” script will run each tutorial with two arguments,
the 1) command name and 2) configuration file.  The configuration file will be a path
on the local machine; the script will translate that to the container path, and execute
the command in the container with the container’s copy of the file.  For example, the
<strong>wrangle_species_list</strong> tutorial can be initiated with:</p>
<p>for linux/mac systems</p>
<div class="highlight-zsh notranslate"><div class="highlight"><pre><span></span>./run_tutorial.sh wrangle_species_list ./data/config/resolve_list_names.json
</pre></div>
</div>
<p>for windows systems</p>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>run_tutorial.bat data\config\resolve_list_names.json
</pre></div>
</div>
</section>
<section id="behind-the-scenes">
<h2>Behind the scenes<a class="headerlink" href="#behind-the-scenes" title="Permalink to this heading"></a></h2>
<p>The “run_tutorial” script will:</p>
<ol class="arabic simple">
<li><p>Create (if they do not exist) volumes to share data between the host and container.</p></li>
<li><p>Build (if it does not exist) a Docker image.</p></li>
<li><p>Start (if it is not running) a Docker container from the image, with volumes
attached.</p></li>
<li><p>Execute the specified command with the parameters in the specified configuration
file. directory.  The process will:</p>
<ol class="arabic simple">
<li><p>read files from the container <strong>/volumes/data</strong> directory</p></li>
<li><p>write outputs and logs to the container <strong>/volumes/output</strong> directory</p></li>
</ol>
</li>
<li><p>Copy the container <strong>/volumes/output</strong> directory back to the local data directory.</p></li>
<li><p>Stop and delete the container.  All outputs in the docker volume are preserved and
accessible the next time it is attached to a container.</p></li>
</ol>
<p>Some tools will require an additional JSON-format configuration file.  In these cases,
the JSON file will be specified in the command-configuration file.</p>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this heading"></a></h2>
<p>All outputs are specified in the Tool Configuration File provided to the command, and
will be copied to the data/outputs directory on completion.</p>
</section>
<section id="summary-of-tutorial-commands">
<h2>Summary of tutorial commands<a class="headerlink" href="#summary-of-tutorial-commands" title="Permalink to this heading"></a></h2>
<p>Tools can be called with the run_tutorial script:</p>
<div class="highlight-zsh notranslate"><div class="highlight"><pre><span></span>./run_tutorial.sh  &lt;command&gt;  &lt;tool_configuration_file&gt;
</pre></div>
</div>
<p>Sending the command <strong>list_commands</strong> will print all valid commands.</p>
<div class="highlight-zsh notranslate"><div class="highlight"><pre><span></span>./run_tutorial.sh list_commands
./run_tutorial.sh wrangle_species_list  data/config/resolve_list_names.json
./run_tutorial.sh wrangle_tree data/config/resolve_tree_names.json
./run_tutorial.sh wrangle_occurrences  data/config/resolve_occurrence_names.json
./run_tutorial.sh split_occurrence_data  data/config/split_occurrence_data_dwca.json
./run_tutorial.sh clean_occurrences  data/config/clean_occurrences.json
./run_tutorial.sh build_grid  data/config/build_shapegrid.json
./run_tutorial.sh encode_layers  data/config/encode_layers.json
./run_tutorial.sh calculate_pam_stats  data/config/calc_pam_stats.json
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Biotaphy Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>