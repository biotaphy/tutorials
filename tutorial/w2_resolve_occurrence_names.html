<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resolve names in occurrence data &mdash; Biotaphy Tutorials 1.0a1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Biotaphy Tutorials
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Biotaphy Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Resolve names in occurrence data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/w2_resolve_occurrence_names.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="resolve-names-in-occurrence-data">
<h1>Resolve names in occurrence data<a class="headerlink" href="#resolve-names-in-occurrence-data" title="Permalink to this headline"></a></h1>
<p><strong>Webinar #2</strong>  Resolving Nomenclature: Making Appropriate Taxonomic Choices</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>Read <a class="reference internal" href="w1_overview.html"><span class="doc std std-doc">Tutorial Overview</span></a> for an overview of how all tutorials work.</p>
</section>
<section id="data-preparation">
<h2>Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline"></a></h2>
<section id="input-occurrence-data">
<h3>Input: occurrence data<a class="headerlink" href="#input-occurrence-data" title="Permalink to this headline"></a></h3>
<p>Either,</p>
<ol class="arabic simple">
<li><p>a file containing tab or comma-delimited records of specimen occurrence data; or</p></li>
<li><p>a Darwin Core Archive (DwCA) of occurrence data.</p></li>
</ol>
<p>GBIF and iDigBio provide portals for querying for, and downloading either CSVs or DwCAs.</p>
</section>
<section id="configuration-file">
<h3>Configuration File<a class="headerlink" href="#configuration-file" title="Permalink to this headline"></a></h3>
<p>A JSON configuration file is required for this command.  These are the required and
optional parameters:</p>
<ul class="simple">
<li><p>Required:</p>
<ul>
<li><p><strong>out_dir</strong>: The parent output directory for CSVs of occurrence records resulting
from splitting the data by species (or other grouping field).</p></li>
</ul>
</li>
<li><p>Optional</p>
<ul>
<li><p><strong>max_open_writers</strong>: The maximum number of files that can be open at one time for
writing occurrence records.  The default value of 100 is appropriate for most
systems.</p></li>
<li><p><strong>key_field</strong>: The field name (or names) to use for filenames.  This/these must be
encased in square brackets, i.e. <code class="docutils literal notranslate"><span class="pre">&quot;key_field&quot;:</span> <span class="pre">[&quot;scientificName&quot;]</span></code>. If multiple fields
are provided, the ordered fields specify the sub-directory structure used for
organizing files.  The first field will specify the directory directly under
out_dir, and so on.  The final field will be contain the base filename.  These
fields should be hierarchical.  For example, if grouping records into files by
species, with a dataset containing 2000 species, using taxonomic grouping fields
(in order from coarser to finer groups)
such as <code class="docutils literal notranslate"><span class="pre">&quot;key_field&quot;:</span> <span class="pre">[&quot;family&quot;,</span> <span class="pre">&quot;genus&quot;,</span> <span class="pre">&quot;species&quot;]</span></code> would create a file
with records for the Giant Panda in
“&lt;out_dir&gt;/Ursidae/Ailuropoda/Ailuropoda melanoleuca.csv”.<br />
If this parameter is not specified, it will default to the fieldname for grouping
data.  This is a required argument for CSV files and defaults to “scientificName”
in DwCA files.  If there are more groups/files than are allowed in a directory, the<br />
files will be written to subdirectories by the beginning characters in the species
name.</p></li>
<li><p><strong>out_field</strong>: The field name or names of columns to be included in output CSV files.
If this field is left out, all fields from the first successfully processed record
will be included in outputs.</p></li>
<li><p><strong>dwca</strong>: List of 0 or more lists, each containing 2 arguments</p>
<ul>
<li><p>input DwCA file, and</p></li>
<li><p>occurrence data wrangler configuration file</p></li>
</ul>
</li>
<li><p><strong>csv</strong>:  List of 0 or more lists, each containing 5 arguments</p>
<ul>
<li><p>input CSV file</p></li>
<li><p>occurrence data wrangler configuration file</p></li>
<li><p>fieldname for grouping data (often a taxonomic designation such as scientificName)</p></li>
<li><p>fieldname for the longitude/x coordinate</p></li>
<li><p>fieldname for the latitude/y coordinate</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>An example configuration file to process a DwCA, using data wranglers specified in
wrangler_conf_resolve_occurrence_names.json, writing all files to the
/biotaphy_data/output directory.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;max_open_writers&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nt">&quot;key_field&quot;</span><span class="p">:</span> <span class="s2">&quot;scientificName&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dwca&quot;</span><span class="p">:</span>  <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;/biotaphy_data/input/occ_idigbio.zip&quot;</span><span class="p">,</span>
         <span class="s2">&quot;/biotaphy_data/param_config/wrangler_conf_resolve_occurrence_names.json&quot;</span>
        <span class="p">]</span>
    <span class="p">],</span>
    <span class="nt">&quot;out_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;/biotaphy_data/output&quot;</span>

<span class="p">}</span>
</pre></div>
</div>
<p>An example configuration file to process a CSV, using data wranglers specified in
wrangler_conf_resolve_occurrence_names2.json, writing the files to the
/biotaphy_data/output directory.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;max_open_writers&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nt">&quot;key_field&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="s2">&quot;genus&quot;</span><span class="p">,</span> <span class="s2">&quot;scientificName&quot;</span><span class="p">],</span>
    <span class="nt">&quot;csv&quot;</span><span class="p">:</span>  <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;/biotaphy_data/input/big_data.csv&quot;</span><span class="p">,</span>
         <span class="s2">&quot;/biotaphy_data/param_config/some_wrangler_conf.json&quot;</span><span class="p">,</span>
         <span class="s2">&quot;scientificName&quot;</span><span class="p">,</span> 
          <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> 
          <span class="s2">&quot;latitude&quot;</span>
        <span class="p">]</span>
    <span class="p">],</span>
    <span class="nt">&quot;out_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;/biotaphy_data/output&quot;</span>

<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="input-wrangler-configuration-file">
<h3>Input: Wrangler configuration file<a class="headerlink" href="#input-wrangler-configuration-file" title="Permalink to this headline"></a></h3>
<p>A file specifying 0 or more occurrence-wranglers to apply to the occurrence data, and<br />
options specific to each.</p>
<p>The resolve_occurrence_names.json  configuration file consists of one or more Occurrence
Data Wranglers (wrangler_type), and the wrangler-specific required and possibly optional
parameters for each.  Configuration files:</p>
<ul class="simple">
<li><p>are in JSON format, a list of one dictionary per desired wrangler.</p></li>
<li><p>Each dictionary must contain “wrangler_type”, with the name of the wrangler types.</p></li>
<li><p>The dictionary will also contain all required parameters and any optional parameters.</p></li>
<li><p>The <a class="reference internal" href="occurrence_wrangler_config.html"><span class="doc std std-doc">Occurrence Data Wrangler Types</span></a> page contains a
list of all occurrence data wrangler_types and the required and/or optional
parameters for each.</p></li>
<li><p>Example resolve_occurrence_names wrangler configuration:</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;wrangler_type&quot;</span><span class="p">:</span> <span class="s2">&quot;AcceptedNameOccurrenceWrangler&quot;</span><span class="p">,</span>
        <span class="nt">&quot;name_resolver&quot;</span><span class="p">:</span> <span class="s2">&quot;gbif&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="run-tutorial">
<h2>Run tutorial<a class="headerlink" href="#run-tutorial" title="Permalink to this headline"></a></h2>
<p>Initiate the process with the following:</p>
<p>for linux/mac systems</p>
<div class="highlight-zsh notranslate"><div class="highlight"><pre><span></span>bash run_tutorial.sh split_occurrence_data data/input/resolve_occurrence_names.json
</pre></div>
</div>
<p>for windows:</p>
<div class="highlight-cmd notranslate"><div class="highlight"><pre><span></span>run_tutorial.bat split_occurrence_data data\input\resolve_occurrence_names.json
</pre></div>
</div>
</section>
<section id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline"></a></h2>
<p>This process outputs a set of CSV files, one per species, in which each record is
annotated with an “accepted name” as defined in a name-map or by a taxonomic service.
Current available taxonomic services include only GBIF at this time.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Biotaphy Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>